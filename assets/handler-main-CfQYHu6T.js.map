{"version":3,"file":"handler-main-CfQYHu6T.js","sources":["../../src/handlers/handler-main.js"],"sourcesContent":["import { fetchMuscles, fetchParts, fetchEquipment } from '../service/fetch.js';\nimport { handleStartLinkClick } from '../service/modal-utils.js';\n\nlet currentFilter = 'Muscles';\nlet base_category = 'abs';\nlet newId = 0;\nlet filter_parts = 'bodypart';\nlet CURRENT_page = 1;\n\nlet musclesListListener = null;\nlet equipmentListListener = null;\nlet searchFormListener = null;\nlet btnContainerListener = null;\nlet listContainerListener = null;\nlet favoritesUpdatedListener = null;\n\n/**\n * Initialize the main page handlers\n * This function attaches all event listeners for the index page\n */\nexport function initMainHandler() {\n  const exercise_filter = document.querySelectorAll('.exercise-link');\n  const btnContainer = document.querySelector('.exercise-btn-container');\n  const search_form = document.querySelector('.filter-search_wrapper');\n  const muscles_list = document.querySelector('.exercise-muscles_list');\n  const equipment_list = document.querySelector('.exercise-equipment_list');\n  const listContainer = document.querySelector('.exercise-parts_list');\n  const exerciseModal = document.querySelector('.exercise-modal');\n\n  // Remove old event listeners if they exist\n  if (musclesListListener && muscles_list) {\n    muscles_list.removeEventListener('click', musclesListListener);\n  }\n  if (equipmentListListener && equipment_list) {\n    equipment_list.removeEventListener('click', equipmentListListener);\n  }\n  if (searchFormListener && search_form) {\n    search_form.removeEventListener('submit', searchFormListener);\n  }\n  if (btnContainerListener && btnContainer) {\n    btnContainer.removeEventListener('click', btnContainerListener);\n  }\n  if (listContainerListener && listContainer) {\n    listContainer.removeEventListener('click', listContainerListener);\n  }\n  if (favoritesUpdatedListener) {\n    document.removeEventListener('favoritesUpdated', favoritesUpdatedListener);\n  }\n\n  // Attach muscles list listener\n  musclesListListener = event => {\n    const muscleItem = event.target.closest('.exercise-muscles_item');\n    if (muscleItem) {\n      let muscle_name = muscleItem\n        .querySelector('.exericise-muscles_header')\n        .textContent.trim()\n        .toLowerCase();\n      search_form.style.display = 'block';\n      CURRENT_page = 1;\n      currentFilter = 'Body Parts';\n      base_category = muscle_name;\n      filter_parts = `muscles=${muscle_name}`;\n      fetchParts(CURRENT_page, filter_parts);\n      exercise_filter.forEach(link => link.classList.remove('active'));\n      document\n        .querySelector('.exercise-link.body_parts')\n        .classList.add('active');\n    }\n  };\n  if (muscles_list) {\n    muscles_list.addEventListener('click', musclesListListener);\n  }\n\n  // Attach equipment list listener\n  equipmentListListener = event => {\n    const equipmentItem = event.target.closest('.exercise-equipment_item');\n    if (equipmentItem) {\n      let equipment_name = equipmentItem\n        .querySelector('.exercise-equipment_header')\n        .textContent.trim()\n        .toLowerCase();\n      search_form.style.display = 'block';\n      CURRENT_page = 1;\n      currentFilter = 'Body Parts';\n      base_category = equipment_name;\n      filter_parts = `equipment=${equipment_name}`;\n      fetchParts(CURRENT_page, filter_parts);\n      exercise_filter.forEach(link => link.classList.remove('active'));\n      document\n        .querySelector('.exercise-link.body_parts')\n        .classList.add('active');\n    }\n  };\n  if (equipment_list) {\n    equipment_list.addEventListener('click', equipmentListListener);\n  }\n\n  // Attach exercise filter listeners\n  exercise_filter.forEach(link => {\n    link.addEventListener('click', function (e) {\n      e.preventDefault();\n      if (e.target.classList.contains('muscles')) {\n        search_form.style.display = 'none';\n        CURRENT_page = 1;\n        currentFilter = 'Muscles';\n        fetchMuscles();\n      } else if (e.target.classList.contains('body_parts')) {\n        search_form.style.display = 'block';\n        CURRENT_page = 1;\n        currentFilter = 'Body Parts';\n        filter_parts = 'bodypart';\n        fetchParts(CURRENT_page, filter_parts);\n      } else if (e.target.classList.contains('equipment')) {\n        search_form.style.display = 'none';\n        CURRENT_page = 1;\n        currentFilter = 'Equipment';\n        fetchEquipment();\n      }\n    });\n  });\n\n  // Attach search form listener\n  searchFormListener = event => {\n    event.preventDefault();\n    const searchInput = event.currentTarget.elements.search;\n    const query = searchInput.value.trim().toLowerCase();\n    if (query === '') return;\n    fetchParts(CURRENT_page, `muscles=${base_category}&keyword=${query}`);\n    search_form.reset();\n    search_form.elements.search.blur();\n  };\n  if (search_form) {\n    search_form.addEventListener('submit', searchFormListener);\n  }\n\n  // Attach button container listener\n  btnContainerListener = event => {\n    const button = event.target.closest('.exercise-button');\n    if (button && !button.disabled) {\n      btnContainer\n        .querySelector('.exercise-button.active')\n        ?.classList.remove('active');\n      button.classList.add('active');\n      // Get page number from data-page attribute (for nav buttons) or textContent (for number buttons)\n      CURRENT_page = parseInt(button.dataset.page || button.textContent);\n      switch (currentFilter) {\n        case 'Muscles':\n          fetchMuscles(CURRENT_page);\n          break;\n        case 'Body Parts':\n          fetchParts(CURRENT_page, filter_parts);\n          break;\n        case 'Equipment':\n          fetchEquipment(CURRENT_page);\n          break;\n      }\n    }\n  };\n  if (btnContainer) {\n    btnContainer.addEventListener('click', btnContainerListener);\n  }\n\n  // Attach list container listener\n  listContainerListener = async event => {\n    const handled = handleStartLinkClick(event);\n    if (handled) {\n      newId = event.target.closest('.start-link').id;\n    }\n  };\n  if (listContainer) {\n    listContainer.addEventListener('click', listContainerListener);\n  }\n\n  // Attach favorites updated listener\n  favoritesUpdatedListener = () => {\n    // initFavoriteButton is now called immediately inside renderModal\n    // No need to re-initialize here\n  };\n  document.addEventListener('favoritesUpdated', favoritesUpdatedListener);\n}\n"],"names":["currentFilter","base_category","filter_parts","CURRENT_page","musclesListListener","equipmentListListener","searchFormListener","btnContainerListener","listContainerListener","favoritesUpdatedListener","initMainHandler","exercise_filter","btnContainer","search_form","muscles_list","equipment_list","listContainer","event","muscleItem","muscle_name","fetchParts","link","equipmentItem","equipment_name","fetchMuscles","fetchEquipment","query","button","_a","handleStartLinkClick"],"mappings":"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"}