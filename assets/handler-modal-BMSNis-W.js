let a=null,l=null,u=null,m=null,g=[],d=null;function h(){const t=document.querySelector(".exercise-modal"),n=document.querySelector(".rating-modal"),o=document.querySelector(".form-rating"),L=document.querySelector(".form-rating");a&&o&&o.removeEventListener("submit",a),l&&t&&t.removeEventListener("click",l),u&&n&&n.removeEventListener("click",u),m&&document.removeEventListener("keydown",m),g.forEach(({input:e,listener:i})=>{e.removeEventListener("change",i)}),g=[],a=async e=>{e.preventDefault();const i=document.querySelector(".form-input"),s=document.querySelector(".form-textarea"),f=document.querySelector('input[name="rating"]:checked'),E=i.value.trim(),b=s.value.trim(),v=f?f.value:null,y=Number(v);if(console.log(typeof y),!v){alert("Please select a rating");return}try{const c=await fetch(`https://your-energy.b.goit.study/api/exercises/${d}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:y,email:E,review:b})});c.ok?(console.log("Rating submitted successfully"),L.reset(),alert("Rating submitted successfully"),r&&(r.textContent="0.0"),n.classList.remove("is-active")):(console.error("Failed to submit rating:",c.status),alert("Failed to submit rating. Please try again."))}catch(c){console.error("Error submitting rating:",c),alert("An error occurred. Please try again.")}},o&&o.addEventListener("submit",a);const p=document.querySelectorAll('input[name="rating"]'),r=document.getElementById("rating-count");p.forEach(e=>{const i=()=>{r&&(r.textContent=`${e.value}.0`)};e.addEventListener("change",i),g.push({input:e,listener:i})}),l=e=>{if(e.target.closest(".exercise-modal_close")&&t.classList.remove("is-active"),e.target.closest(".modal-rating_btn")){const s=document.querySelector(".exercise-modal_content").querySelector(".modal-favorites_btn");d=s?s.id:null,r&&(r.textContent="0.0"),t.classList.remove("is-active"),setTimeout(()=>{n.classList.add("is-active")},250)}e.target===t&&t.classList.remove("is-active")},t&&t.addEventListener("click",l),u=e=>{(e.target.closest(".rating-modal_close")||e.target===n)&&(n.classList.remove("is-active"),d=null,r&&(r.textContent="0.0"))},n&&n.addEventListener("click",u),m=e=>{e.key==="Escape"&&(t==null||t.classList.remove("is-active"),n==null||n.classList.remove("is-active"),d=null,r&&(r.textContent="0.0"))},document.addEventListener("keydown",m)}export{h as initModalHandler};
//# sourceMappingURL=handler-modal-BMSNis-W.js.map
