{"version":3,"file":"handler-main-BQlh4gs2.js","sources":["../../src/handlers/handler-main.js"],"sourcesContent":["import {\n  fetchMuscles,\n  fetchParts,\n  fetchEquipment,\n  fetchBodyParts,\n} from '../service/fetch.js';\nimport { handleStartLinkClick } from '../service/modal-utils.js';\n\nlet currentFilter = 'Muscles';\nlet base_category = 'abs';\nlet newId = 0;\nlet filter_parts = 'bodypart';\nlet CURRENT_page = 1;\n\nlet musclesListListener = null;\nlet bodyPartsListListener = null;\nlet equipmentListListener = null;\nlet searchFormListener = null;\nlet btnContainerListener = null;\nlet listContainerListener = null;\nlet favoritesUpdatedListener = null;\n\n/**\n * Initialize the main page handlers\n * This function attaches all event listeners for the index page\n */\nexport function initMainHandler() {\n  const exercise_filter = document.querySelectorAll('.exercise-link');\n  const btnContainer = document.querySelector('.exercise-btn-container');\n  const search_form = document.querySelector('.filter-search_wrapper');\n  const muscles_list = document.querySelector('.exercise-muscles_list');\n  const bodyParts_list = document.querySelector('.exercise-bodyparts_list');\n  const equipment_list = document.querySelector('.exercise-equipment_list');\n  const listContainer = document.querySelector('.exercise-parts_list');\n  const exercise_header = document.querySelector('.exercise-header');\n  const filter_text = document.querySelector('.exercise-filter_text');\n\n  // Remove old event listeners if they exist\n  if (musclesListListener && muscles_list) {\n    muscles_list.removeEventListener('click', musclesListListener);\n  }\n  if (bodyPartsListListener && bodyParts_list) {\n    bodyParts_list.removeEventListener('click', bodyPartsListListener);\n  }\n  if (equipmentListListener && equipment_list) {\n    equipment_list.removeEventListener('click', equipmentListListener);\n  }\n  if (searchFormListener && search_form) {\n    search_form.removeEventListener('submit', searchFormListener);\n  }\n  if (btnContainerListener && btnContainer) {\n    btnContainer.removeEventListener('click', btnContainerListener);\n  }\n  if (listContainerListener && listContainer) {\n    listContainer.removeEventListener('click', listContainerListener);\n  }\n  if (favoritesUpdatedListener) {\n    document.removeEventListener('favoritesUpdated', favoritesUpdatedListener);\n  }\n\n  // Attach muscles list listener\n  musclesListListener = event => {\n    const muscleItem = event.target.closest('.exercise-muscles_item');\n    if (muscleItem) {\n      let muscle_name = muscleItem\n        .querySelector('.exericise-muscles_header')\n        .textContent.trim()\n        .toLowerCase();\n      filter_text.textContent = muscle_name;\n      exercise_header.textContent = 'Exercise /';\n      search_form.style.display = 'block';\n      CURRENT_page = 1;\n      currentFilter = 'Body Parts';\n      base_category = muscle_name;\n      filter_parts = `muscles=${muscle_name}`;\n      fetchParts(CURRENT_page, filter_parts);\n      exercise_filter.forEach(link => link.classList.remove('active'));\n      document.querySelector('.exercise-link.muscles').classList.add('active');\n    }\n  };\n  if (muscles_list) {\n    muscles_list.addEventListener('click', musclesListListener);\n  }\n\n  // Attach body parts list listener\n  bodyPartsListListener = event => {\n    const bodyPartItem = event.target.closest('.exercise-bodyparts_item');\n    if (bodyPartItem) {\n      console.log(bodyPartItem);\n      let bodyPart_name = bodyPartItem\n        .querySelector('.exercise-bodyparts_header')\n        .textContent.trim()\n        .toLowerCase();\n      filter_text.textContent = bodyPart_name;\n      exercise_header.textContent = 'Exercise /';\n      search_form.style.display = 'block';\n      CURRENT_page = 1;\n      currentFilter = 'Body Parts';\n      base_category = bodyPart_name;\n      filter_parts = `bodypart=${bodyPart_name}`;\n      fetchParts(CURRENT_page, filter_parts);\n      exercise_filter.forEach(link => link.classList.remove('active'));\n      document\n        .querySelector('.exercise-link.body_parts')\n        .classList.add('active');\n    }\n  };\n  if (bodyParts_list) {\n    bodyParts_list.addEventListener('click', bodyPartsListListener);\n  }\n\n  // Attach equipment list listener\n  equipmentListListener = event => {\n    const equipmentItem = event.target.closest('.exercise-equipment_item');\n    if (equipmentItem) {\n      let equipment_name = equipmentItem\n        .querySelector('.exercise-equipment_header')\n        .textContent.trim()\n        .toLowerCase();\n      filter_text.textContent = equipment_name;\n      exercise_header.textContent = 'Exercise /';\n      search_form.style.display = 'block';\n      CURRENT_page = 1;\n      currentFilter = 'Body Parts';\n      base_category = equipment_name;\n      filter_parts = `equipment=${equipment_name}`;\n      fetchParts(CURRENT_page, filter_parts);\n      exercise_filter.forEach(link => link.classList.remove('active'));\n      document\n        .querySelector('.exercise-link.equipment')\n        .classList.add('active');\n    }\n  };\n  if (equipment_list) {\n    equipment_list.addEventListener('click', equipmentListListener);\n  }\n\n  // Attach exercise filter listeners\n  exercise_filter.forEach(link => {\n    link.addEventListener('click', function (e) {\n      e.preventDefault();\n      if (e.target.classList.contains('muscles')) {\n        search_form.style.display = 'none';\n        filter_text.textContent = '';\n        exercise_header.textContent = 'Exercise';\n        CURRENT_page = 1;\n        currentFilter = 'Muscles';\n        fetchMuscles();\n      } else if (e.target.classList.contains('body_parts')) {\n        search_form.style.display = 'none';\n        filter_text.textContent = '';\n        exercise_header.textContent = 'Exercise';\n        CURRENT_page = 1;\n        currentFilter = 'Body Parts';\n        filter_parts = 'bodypart';\n        fetchBodyParts();\n      } else if (e.target.classList.contains('equipment')) {\n        search_form.style.display = 'none';\n        filter_text.textContent = '';\n        exercise_header.textContent = 'Exercise';\n        CURRENT_page = 1;\n        currentFilter = 'Equipment';\n        fetchEquipment();\n      }\n    });\n  });\n\n  // Attach search form listener\n  searchFormListener = event => {\n    event.preventDefault();\n    const searchInput = event.currentTarget.elements.search;\n    const query = searchInput.value.trim().toLowerCase();\n    if (query === '') return;\n    fetchParts(CURRENT_page, `muscles=${base_category}&keyword=${query}`);\n    search_form.reset();\n    search_form.elements.search.blur();\n  };\n  if (search_form) {\n    search_form.addEventListener('submit', searchFormListener);\n  }\n\n  // Attach button container listener\n  btnContainerListener = event => {\n    const button = event.target.closest('.exercise-button');\n    if (button && !button.disabled) {\n      btnContainer\n        .querySelector('.exercise-button.active')\n        ?.classList.remove('active');\n      button.classList.add('active');\n      // Get page number from data-page attribute (for nav buttons) or textContent (for number buttons)\n      CURRENT_page = parseInt(button.dataset.page || button.textContent);\n      switch (currentFilter) {\n        case 'Muscles':\n          fetchMuscles(CURRENT_page);\n          break;\n        case 'Body Parts':\n          fetchParts(CURRENT_page, filter_parts);\n          break;\n        case 'Equipment':\n          fetchEquipment(CURRENT_page);\n          break;\n      }\n    }\n  };\n  if (btnContainer) {\n    btnContainer.addEventListener('click', btnContainerListener);\n  }\n\n  // Attach list container listener\n  listContainerListener = async event => {\n    const handled = handleStartLinkClick(event);\n    if (handled) {\n      newId = event.target.closest('.start-link').id;\n    }\n  };\n  if (listContainer) {\n    listContainer.addEventListener('click', listContainerListener);\n  }\n\n  // Attach favorites updated listener\n  favoritesUpdatedListener = () => {\n    // initFavoriteButton is now called immediately inside renderModal\n    // No need to re-initialize here\n  };\n  document.addEventListener('favoritesUpdated', favoritesUpdatedListener);\n}\n"],"names":["currentFilter","base_category","filter_parts","CURRENT_page","musclesListListener","bodyPartsListListener","equipmentListListener","searchFormListener","btnContainerListener","listContainerListener","favoritesUpdatedListener","initMainHandler","exercise_filter","btnContainer","search_form","muscles_list","bodyParts_list","equipment_list","listContainer","exercise_header","filter_text","event","muscleItem","muscle_name","fetchParts","link","bodyPartItem","bodyPart_name","equipmentItem","equipment_name","fetchMuscles","fetchBodyParts","fetchEquipment","query","button","_a","handleStartLinkClick"],"mappings":"0EAQA,IAAIA,EAAgB,UAChBC,EAAgB,MAEhBC,EAAe,WACfC,EAAe,EAEfC,EAAsB,KACtBC,EAAwB,KACxBC,EAAwB,KACxBC,EAAqB,KACrBC,EAAuB,KACvBC,EAAwB,KACxBC,EAA2B,KAMxB,SAASC,GAAkB,CAChC,MAAMC,EAAkB,SAAS,iBAAiB,gBAAgB,EAC5DC,EAAe,SAAS,cAAc,yBAAyB,EAC/DC,EAAc,SAAS,cAAc,wBAAwB,EAC7DC,EAAe,SAAS,cAAc,wBAAwB,EAC9DC,EAAiB,SAAS,cAAc,0BAA0B,EAClEC,EAAiB,SAAS,cAAc,0BAA0B,EAClEC,EAAgB,SAAS,cAAc,sBAAsB,EAC7DC,EAAkB,SAAS,cAAc,kBAAkB,EAC3DC,EAAc,SAAS,cAAc,uBAAuB,EAG9DhB,GAAuBW,GACzBA,EAAa,oBAAoB,QAASX,CAAmB,EAE3DC,GAAyBW,GAC3BA,EAAe,oBAAoB,QAASX,CAAqB,EAE/DC,GAAyBW,GAC3BA,EAAe,oBAAoB,QAASX,CAAqB,EAE/DC,GAAsBO,GACxBA,EAAY,oBAAoB,SAAUP,CAAkB,EAE1DC,GAAwBK,GAC1BA,EAAa,oBAAoB,QAASL,CAAoB,EAE5DC,GAAyBS,GAC3BA,EAAc,oBAAoB,QAAST,CAAqB,EAE9DC,GACF,SAAS,oBAAoB,mBAAoBA,CAAwB,EAI3EN,EAAsBiB,GAAS,CAC7B,MAAMC,EAAaD,EAAM,OAAO,QAAQ,wBAAwB,EAChE,GAAIC,EAAY,CACd,IAAIC,EAAcD,EACf,cAAc,2BAA2B,EACzC,YAAY,KAAM,EAClB,cACHF,EAAY,YAAcG,EAC1BJ,EAAgB,YAAc,aAC9BL,EAAY,MAAM,QAAU,QAC5BX,EAAe,EACfH,EAAgB,aAChBC,EAAgBsB,EAChBrB,EAAe,WAAWqB,CAAW,GACrCC,EAAWrB,EAAcD,CAAY,EACrCU,EAAgB,QAAQa,GAAQA,EAAK,UAAU,OAAO,QAAQ,CAAC,EAC/D,SAAS,cAAc,wBAAwB,EAAE,UAAU,IAAI,QAAQ,CACxE,CACL,EACMV,GACFA,EAAa,iBAAiB,QAASX,CAAmB,EAI5DC,EAAwBgB,GAAS,CAC/B,MAAMK,EAAeL,EAAM,OAAO,QAAQ,0BAA0B,EACpE,GAAIK,EAAc,CAChB,QAAQ,IAAIA,CAAY,EACxB,IAAIC,EAAgBD,EACjB,cAAc,4BAA4B,EAC1C,YAAY,KAAM,EAClB,cACHN,EAAY,YAAcO,EAC1BR,EAAgB,YAAc,aAC9BL,EAAY,MAAM,QAAU,QAC5BX,EAAe,EACfH,EAAgB,aAChBC,EAAgB0B,EAChBzB,EAAe,YAAYyB,CAAa,GACxCH,EAAWrB,EAAcD,CAAY,EACrCU,EAAgB,QAAQa,GAAQA,EAAK,UAAU,OAAO,QAAQ,CAAC,EAC/D,SACG,cAAc,2BAA2B,EACzC,UAAU,IAAI,QAAQ,CAC1B,CACL,EACMT,GACFA,EAAe,iBAAiB,QAASX,CAAqB,EAIhEC,EAAwBe,GAAS,CAC/B,MAAMO,EAAgBP,EAAM,OAAO,QAAQ,0BAA0B,EACrE,GAAIO,EAAe,CACjB,IAAIC,EAAiBD,EAClB,cAAc,4BAA4B,EAC1C,YAAY,KAAM,EAClB,cACHR,EAAY,YAAcS,EAC1BV,EAAgB,YAAc,aAC9BL,EAAY,MAAM,QAAU,QAC5BX,EAAe,EACfH,EAAgB,aAChBC,EAAgB4B,EAChB3B,EAAe,aAAa2B,CAAc,GAC1CL,EAAWrB,EAAcD,CAAY,EACrCU,EAAgB,QAAQa,GAAQA,EAAK,UAAU,OAAO,QAAQ,CAAC,EAC/D,SACG,cAAc,0BAA0B,EACxC,UAAU,IAAI,QAAQ,CAC1B,CACL,EACMR,GACFA,EAAe,iBAAiB,QAASX,CAAqB,EAIhEM,EAAgB,QAAQa,GAAQ,CAC9BA,EAAK,iBAAiB,QAAS,SAAU,EAAG,CAC1C,EAAE,eAAc,EACZ,EAAE,OAAO,UAAU,SAAS,SAAS,GACvCX,EAAY,MAAM,QAAU,OAC5BM,EAAY,YAAc,GAC1BD,EAAgB,YAAc,WAC9BhB,EAAe,EACfH,EAAgB,UAChB8B,KACS,EAAE,OAAO,UAAU,SAAS,YAAY,GACjDhB,EAAY,MAAM,QAAU,OAC5BM,EAAY,YAAc,GAC1BD,EAAgB,YAAc,WAC9BhB,EAAe,EACfH,EAAgB,aAChBE,EAAe,WACf6B,KACS,EAAE,OAAO,UAAU,SAAS,WAAW,IAChDjB,EAAY,MAAM,QAAU,OAC5BM,EAAY,YAAc,GAC1BD,EAAgB,YAAc,WAC9BhB,EAAe,EACfH,EAAgB,YAChBgC,IAER,CAAK,CACL,CAAG,EAGDzB,EAAqBc,GAAS,CAC5BA,EAAM,eAAc,EAEpB,MAAMY,EADcZ,EAAM,cAAc,SAAS,OACvB,MAAM,KAAM,EAAC,YAAW,EAC9CY,IAAU,KACdT,EAAWrB,EAAc,WAAWF,CAAa,YAAYgC,CAAK,EAAE,EACpEnB,EAAY,MAAK,EACjBA,EAAY,SAAS,OAAO,OAChC,EACMA,GACFA,EAAY,iBAAiB,SAAUP,CAAkB,EAI3DC,EAAuBa,GAAS,OAC9B,MAAMa,EAASb,EAAM,OAAO,QAAQ,kBAAkB,EACtD,GAAIa,GAAU,CAACA,EAAO,SAOpB,QANAC,EAAAtB,EACG,cAAc,yBAAyB,IAD1C,MAAAsB,EAEI,UAAU,OAAO,UACrBD,EAAO,UAAU,IAAI,QAAQ,EAE7B/B,EAAe,SAAS+B,EAAO,QAAQ,MAAQA,EAAO,WAAW,EACzDlC,EAAa,CACnB,IAAK,UACH8B,EAAa3B,CAAY,EACzB,MACF,IAAK,aACHqB,EAAWrB,EAAcD,CAAY,EACrC,MACF,IAAK,YACH8B,EAAe7B,CAAY,EAC3B,KACH,CAEP,EACMU,GACFA,EAAa,iBAAiB,QAASL,CAAoB,EAI7DC,EAAwB,MAAMY,GAAS,CACrBe,EAAqBf,CAAK,GAEhCA,EAAM,OAAO,QAAQ,aAAa,EAAE,EAElD,EACMH,GACFA,EAAc,iBAAiB,QAAST,CAAqB,EAI/DC,EAA2B,IAAM,CAGnC,EACE,SAAS,iBAAiB,mBAAoBA,CAAwB,CACxE"}