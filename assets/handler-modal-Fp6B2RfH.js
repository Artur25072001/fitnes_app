let c=null,l=null,m=null,u=null,g=[],d=null;function h(){const t=document.querySelector(".exercise-modal"),n=document.querySelector(".rating-modal"),o=document.querySelector(".form-rating"),y=document.querySelector(".form-rating");c&&o&&o.removeEventListener("submit",c),l&&t&&t.removeEventListener("click",l),m&&n&&n.removeEventListener("click",m),u&&document.removeEventListener("keydown",u),g.forEach(({input:e,listener:i})=>{e.removeEventListener("change",i)}),g=[],c=async e=>{e.preventDefault();const i=document.querySelector(".form-input"),s=document.querySelector(".form-textarea"),v=document.querySelector('input[name="rating"]:checked'),p=i.value.trim(),E=s.value.trim(),f=v?v.value:null;if(!f){alert("Please select a rating");return}try{const a=await fetch(`https://your-energy.b.goit.study/api/exercises/${d}/rating`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:parseInt(f),email:p,review:E})});a.ok?(console.log("Rating submitted successfully"),y.reset(),r&&(r.textContent="0.0"),n.classList.remove("is-active")):(console.error("Failed to submit rating:",a.status),alert("Failed to submit rating. Please try again."))}catch(a){console.error("Error submitting rating:",a),alert("An error occurred. Please try again.")}},o&&o.addEventListener("submit",c);const L=document.querySelectorAll('input[name="rating"]'),r=document.getElementById("rating-count");L.forEach(e=>{const i=()=>{r&&(r.textContent=`${e.value}.0`)};e.addEventListener("change",i),g.push({input:e,listener:i})}),l=e=>{if(e.target.closest(".exercise-modal_close")&&t.classList.remove("is-active"),e.target.closest(".modal-rating_btn")){const s=document.querySelector(".exercise-modal_content").querySelector(".modal-favorites_btn");d=s?s.id:null,r&&(r.textContent="0.0"),t.classList.remove("is-active"),setTimeout(()=>{n.classList.add("is-active")},250)}e.target===t&&t.classList.remove("is-active")},t&&t.addEventListener("click",l),m=e=>{(e.target.closest(".rating-modal_close")||e.target===n)&&(n.classList.remove("is-active"),d=null,r&&(r.textContent="0.0"))},n&&n.addEventListener("click",m),u=e=>{e.key==="Escape"&&(t==null||t.classList.remove("is-active"),n==null||n.classList.remove("is-active"),d=null,r&&(r.textContent="0.0"))},document.addEventListener("keydown",u)}export{h as initModalHandler};
//# sourceMappingURL=handler-modal-Fp6B2RfH.js.map
